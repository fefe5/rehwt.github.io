<!-- udacity2.0 -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Async Promises</title>
  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="../assets/css/plyr.css">
  <link rel="stylesheet" href="../assets/css/katex.min.css">
  <link rel="stylesheet" href="../assets/css/jquery.mCustomScrollbar.min.css">
  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="shortcut icon" type="image/png" href="../assets/img/udacimak.png" />
</head>

<body>
  <div class="wrapper">
    <nav id="sidebar">
  <div class="sidebar-header">
    <h3>Asynchronous JavaScript</h3>
  </div>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled components">
    <li class="">
      <a href="01. Async JS.html">01. Async JS</a>
    </li>
    <li class="">
      <a href="02. Async Promises.html">02. Async Promises</a>
    </li>
    <li class="">
      <a href="03. Exercise Async Function.html">03. Exercise: Async Function</a>
    </li>
    <li class="">
      <a href="04. Async Fetch w Web APIs Intro.html">04. Async Fetch w/ Web APIs Intro</a>
    </li>
    <li class="">
      <a href="05. Credentials and API keys.html">05. Credentials and API keys</a>
    </li>
    <li class="">
      <a href="06. Adding Fetch to Your Code.html">06. Adding Fetch to Your Code</a>
    </li>
    <li class="">
      <a href="07. Exercise Async GET.html">07. Exercise: Async GET</a>
    </li>
    <li class="">
      <a href="08. Async Fetch with Web APIs Demo.html">08. Async Fetch with Web APIs Demo</a>
    </li>
    <li class="">
      <a href="09. Chaining Promises.html">09. Chaining Promises</a>
    </li>
    <li class="">
      <a href="10. Updating UI Elements.html">10. Updating UI Elements</a>
    </li>
    <li class="">
      <a href="11. Exercise Putting It All Together.html">11. Exercise: Putting It All Together</a>
    </li>
    <li class="">
      <a href="12. Updating UI Elements Demo.html">12. Updating UI Elements Demo</a>
    </li>
    <li class="">
      <a href="13. Outro.html">13. Outro</a>
    </li>
    <li class="">
      <a href="14. Instructor Interview.html">14. Instructor Interview</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>
</nav>

    <div id="content">
      <header class="container-fluild header">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="align-items-middle">
                <button type="button" id="sidebarCollapse" class="btn btn-toggle-sidebar">
                  <div></div>
                  <div></div>
                  <div></div>
                </button>

                <h1 style="display: inline-block">02. Async Promises</h1>
              </div>
            </div>
          </div>
        </div>
      </header>

      <main class="container">
        <div class="row">
          <div class="col-12">
            <div class="ud-atom">
  <h3><p>JS Async Keywords</p></h3>
  <div>
  <h1 id="async-promises">Async Promises</h1>
<p>While there have always been some async work arounds in JS, including setTimeout(), and AJAX, more recently a tool called Promises has been introduced natively to JavaScript, and Promises are now the accepted best practice for writing asynchronous functions in JavaScript.</p>
<p>You can think of Promises as a special function that either satisfy (resolve) or fail (reject) to execute a task, and then executes the corresponding actions, usually another task with the returned data in the case of 'resolved' and usually throw an error in the case of 'reject'.  </p>
<h3 id="here-is-the-basic-anatomy-of-a-promise">Here is the basic anatomy of a Promise:</h3>
<h4 id="syntax">Syntax</h4>
<pre><code>var promise = new Promise(function(resolve, reject) {
  // do a thing, possibly async, then…

  if (/* everything turned out fine */) {
    resolve("Stuff worked!");
  }
  else {
    reject(Error("It broke"));
  }
});</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Code Demo</p></h3>
  <div>
  <p>There are many methods to handle asynchronous work already, however Promises are the recommended option because they give you flexibility, intuitive syntax, and easy error handling. Promises are an amazing development in JavaScript, but until ES2017 (ES8) they still required extra boilerplate code, called generators, to run asynchronously. Now however, with the addition of native <code>async</code> functions to JavaScript, we can easily apply the async keywords to a Promise to execute asynchronous JavaScript code. </p>
<p>To make a <code>fetch()</code> call, or any other methods inside of a function, asynchronous we must use the keywords provided by JavaScript. Here is an example of an asynchronous fetch function using JavaScript keywords:</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Code Demo</p></h3>
  <div>
  <pre><code>const postData = async ( url = '', data = {})=&gt;{

      const response = await fetch(url, {
      method: 'POST', // *GET, POST, PUT, DELETE, etc.
      credentials: 'same-origin', 
      headers: {
          'Content-Type': 'application/json',
      },
      body: JSON.stringify(data), // body data type must match "Content-Type" header        
    });

      try {
        const newData = await response.json();
               return newData
      }catch(error) {
      console.log("error", error);
      // appropriately handle the error
      }
  }

  postData('/addMovie', {movie:' the matrix', score: 5})</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Async JS Example Prep</p></h3>
  <div>
  <p><code>postData</code> is an async arrow function that is called with parameters on the last line of code. It is asynchronous because of the keyword <code>async</code> placed before its parameters.</p>
<pre><code>const postData = async ( url = '', data = {})=&gt;{
      const response = await fetch(url, {
      method: 'POST',
      credentials: 'same-origin',
      headers: {
          'Content-Type': 'application/json',
      },
      body: JSON.stringify(data),      
    });

...
}</code></pre>
<p>Once you mark a function as 'async' you have access to the keywords <code>await</code>, <code>try</code>, and <code>catch</code>.</p>
<pre><code>   try {
        const newData = await response.json();
        return newData
      }catch(error) {
      console.log("error", error);
      // appropriately handle the error
      }</code></pre>
<p>The keywords <code>try</code> and <code>catch</code> mirror the Promise functionality of resolving or rejecting to execute a task. In this case. <code>if and</code>else<code>are replaced with the keywords</code>try<code>and</code>catch<code>.
a condition The</code>await` keyword is used in places where the next actions requires data from the current action so we want to tell our program to wait until the data has been received before continuing with the next steps-- this is the magic of ASYNC JavaScript.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Async JS Quiz</p></h3>
  <div>
  <form>
    <fieldset>
      <legend><p>Which of these amazing ‘facts’ are also true about asynchronous JavaScript</p></legend>
    </fieldset>

    <div>
      <input type="checkbox" value="rbk1" name="860776" id="rbk1">
      <label for="rbk1"><p>Asynchronous JavaScript is impossible-- don’t even try it.</p></label>
    </div>
    <div>
      <input type="checkbox" value="rbk2" name="860776" id="rbk2">
      <label for="rbk2"><p>Native Promises in JavaScript allow for asynchronous functions that are dependent on satisfying a condition.</p></label>
    </div>
    <div>
      <input type="checkbox" value="rbk3" name="860776" id="rbk3">
      <label for="rbk3"><p>JavaScript functions can be made asynchronous simply by using the keyword <code>async</code>.</p></label>
    </div>
    <div>
      <input type="checkbox" value="rbk4" name="860776" id="rbk4">
      <label for="rbk4"><p>JavaScript functions denoted by the keyword <code>async</code> allow for the syntax of <code>await</code>, <code>try</code>, <code>catch</code>, for an elegant way of dealing with code asynchronously.</p></label>
    </div>
    <div>
      <input type="checkbox" value="rbk5" name="860776" id="rbk5">
      <label for="rbk5"><p>JavaScript naturally runs asynchronously and simply using the keyword <code>await</code> before any method will be sufficient to run code asynchronously.</p></label>
    </div>
  </form>

  <details>
    <summary><strong>SOLUTION:</strong></summary>
    <ul>
      <li>Native Promises in JavaScript allow for asynchronous functions that are dependent on satisfying a condition.</li>
      <li>JavaScript functions can be made asynchronous simply by using the keyword `async`.</li>
      <li>JavaScript functions denoted by the keyword `async` allow for the syntax of `await`, `try`, `catch`, for an elegant way of dealing with code asynchronously.</li>
  </ul>
  </details>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Async JS Summary</p></h3>
  <div>
  <p>In the next lesson we will learn how to pair JavaScript async fetch functions with Web APIS to unleash the dynamic power of front-end programming.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Async JS Further Research</p></h3>
  <div>
  <h3 id="more-on-async-js">More on Async JS</h3>
<p>For a more detailed overview on Promises and why they matter, read the article <a href="https://developers.google.com/web/fundamentals/primers/promises" rel="noopener noreferrer" target="_blank">here</a>.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/screenshot-2020-06-10-at-3.39.36-pm.png" alt="" class="img img-fluid">
    <figcaption class="figure-caption">
      
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div>
          </div>

          <div class="col-12">
            <p class="text-right">
              <a href="03. Exercise Async Function.html" class="btn btn-outline-primary mt-4" role="button">Next Concept</a>
            </p>
          </div>
        </div>
      </main>

      <footer class="footer">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <p class="text-center">
                <a href="https://us-udacity.github.io/" target="_blank">【udacity2.0 】If you need more courses, please add wechat：udacity6</a>
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>


  <script src="../assets/js/jquery-3.3.1.min.js"></script>
  <script src="../assets/js/plyr.polyfilled.min.js"></script>
  <script src="../assets/js/bootstrap.min.js"></script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
  <script src="../assets/js/katex.min.js"></script>
  <script>
    // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('02. Async Promises')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
</body>

</html>
