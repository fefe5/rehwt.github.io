<!-- udacity2.0 -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Phases of an Event</title>
  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="../assets/css/plyr.css">
  <link rel="stylesheet" href="../assets/css/katex.min.css">
  <link rel="stylesheet" href="../assets/css/jquery.mCustomScrollbar.min.css">
  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="shortcut icon" type="image/png" href="../assets/img/udacimak.png" />
</head>

<body>
  <div class="wrapper">
    <nav id="sidebar">
  <div class="sidebar-header">
    <h3>Working with Browser Events</h3>
  </div>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled components">
    <li class="">
      <a href="01. Introduction.html">01. Introduction</a>
    </li>
    <li class="">
      <a href="02. Respond to Events.html">02. Respond to Events</a>
    </li>
    <li class="">
      <a href="03. Remove an Event Listener.html">03. Remove an Event Listener</a>
    </li>
    <li class="">
      <a href="04. Phases of an Event.html">04. Phases of an Event</a>
    </li>
    <li class="">
      <a href="05. Avoid Too Many Events.html">05. Avoid Too Many Events</a>
    </li>
    <li class="">
      <a href="06. Know When The DOM Is Ready.html">06. Know When The DOM Is Ready</a>
    </li>
    <li class="">
      <a href="07. Lesson Summary.html">07. Lesson Summary</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>
</nav>

    <div id="content">
      <header class="container-fluild header">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="align-items-middle">
                <button type="button" id="sidebarCollapse" class="btn btn-toggle-sidebar">
                  <div></div>
                  <div></div>
                  <div></div>
                </button>

                <h1 style="display: inline-block">04. Phases of an Event</h1>
              </div>
            </div>
          </div>
        </div>
      </header>

      <main class="container">
        <div class="row">
          <div class="col-12">
            <div class="ud-atom">
  <h3><p>Reflect</p></h3>
  <div>
  <p><strong>QUESTION: </strong></p>
  <p>Thinking about nodes and how the DOM is structured, after running the code below, which event listener will fire first when the page is clicked? Write out your answer and your explanation of why it will be in that order:</p>
<pre><code class="js language-js">document.addEventListener('click', function () {
   console.log('The document was clicked');
});

document.body.addEventListener('click', function () {
    console.log('The document body was clicked');
});</code></pre>

  <details>
    <summary><strong>ANSWER:</strong></summary>
    <p><p>Thank you for your response.</p></p>
  </details>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h2 id="event-phases">Event Phases</h2>
<p>There are three different phases during the lifecycle of an event. They are:</p>
<ul>
<li>the <strong>capturing</strong> phase</li>
<li>the <strong>at target</strong> phase</li>
<li>and the <strong>bubbling</strong> phase</li>
</ul>
<p>And they actually follow the order above; first, it's <em>capturing</em>, then <em>at target</em>, and then the <em>bubbling</em> phase.</p>
<p>Most event handlers run during the <strong>at target</strong> phase, such as when you attach a click event handler to the button. The event arrives at the button (its <strong>target</strong>), and there's only a handler for it right there, so the event handler gets run.</p>
<p>But sometimes you have a collection of items -- such as a list -- and want to have one handler cover every item (and still have the option of individual handlers for some items.) By default, if you click on a child item and a handler doesn't intercept the click, the event will "bubble" upward to the parent, and keep bubbling until something handles it or it hits the document. </p>
<p>Capturing, on the other hand, lets the parent intercept an event before it reaches a child. </p>
<p>Let's dig into these phases to see how they affect when events fire and the order they fire in!</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>L3 - 35 - Which Is First V1</p></h3>
  <video controls>
  <source src="04. L3 - 35 - Which Is First V1-rGhgPPYc2sg.mp4" type="video/mp4">

  <track default="false" kind="subtitles" srclang="zh-CN" src="04. L3 - 35 - Which Is First V1-rGhgPPYc2sg.zh-CN.vtt" label="zh-CN">
  <track default="false" kind="subtitles" srclang="ar" src="04. L3 - 35 - Which Is First V1-rGhgPPYc2sg.ar.vtt" label="ar">
  <track default="false" kind="subtitles" srclang="pt-BR" src="04. L3 - 35 - Which Is First V1-rGhgPPYc2sg.pt-BR.vtt" label="pt-BR">
  <track default="true" kind="subtitles" srclang="en" src="04. L3 - 35 - Which Is First V1-rGhgPPYc2sg.en.vtt" label="en">
  <track default="false" kind="subtitles" srclang="uz" src="04. L3 - 35 - Which Is First V1-rGhgPPYc2sg.uz.vtt" label="uz">
</video>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/ud117-phases-of-event-flow.svg" alt="_The three event phases of an event: capturing, at target, and bubbling._" class="img img-fluid">
    <figcaption class="figure-caption">
      <p><em>The three event phases of an event: capturing, at target, and bubbling.</em></p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <p>So of the three phases in an event, which one does the <code>.addEventListener()</code> method actually use? And, how can we change it?</p>
<p>Up until this point, we've only seen the <code>.addEventListener()</code> method called with <em>two</em> arguments, the:</p>
<ul>
<li>event <em>type</em></li>
<li>and the <em>listener</em> </li>
</ul>
<pre><code class="js language-js">document.addEventListener('click', function () {
   console.log('The document was clicked');
});</code></pre>
<p>There's actually a <em>third</em> argument to the <code>.addEventListener()</code> method; the <em>useCapture</em> argument. From it's name, you'd think that if this argument were left out, <code>.addEventListener()</code> would default to using the <em>capturing</em> phase. This is an incorrect assumption! <strong>By default, when <code>.addEventListener()</code> is called with only two arguments, the method defaults to using the bubbling phase.</strong></p>
<p>The code below uses <code>.addEventListener()</code> with only two arguments, so it will invoke the listener during the bubbling phase:</p>
<pre><code class="js language-js">document.addEventListener('click', function () {
   console.log('The document was clicked');
});</code></pre>
<p>However, in this code, <code>.addEventListener()</code> is called with <em>three arguments</em> with the third argument being <code>true</code> (meaning it <em>should invoke the listener earlier, during the capturing phase</em>!). </p>
<pre><code class="js language-js">document.addEventListener('click', function () {
   console.log('The document was clicked');
}, true);</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>L3-38 – Capture Walkthru V1</p></h3>
  <video controls>
  <source src="04. L3-38 – Capture Walkthru V1-4WYyk3AhCOU.mp4" type="video/mp4">

  <track default="false" kind="subtitles" srclang="zh-CN" src="04. L3-38 – Capture Walkthru V1-4WYyk3AhCOU.zh-CN.vtt" label="zh-CN">
  <track default="true" kind="subtitles" srclang="en" src="04. L3-38 – Capture Walkthru V1-4WYyk3AhCOU.en.vtt" label="en">
  <track default="false" kind="subtitles" srclang="pt-BR" src="04. L3-38 – Capture Walkthru V1-4WYyk3AhCOU.pt-BR.vtt" label="pt-BR">
  <track default="false" kind="subtitles" srclang="uz" src="04. L3-38 – Capture Walkthru V1-4WYyk3AhCOU.uz.vtt" label="uz">
</video>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <form>
    <fieldset>
      <legend><p>Which of the phases is the following code set up for?</p>
<pre><code class="js language-js">const items = document.querySelectorAll('.quizzing-quizzes');
const el = items[1];

el.addEventListener('click', function () {
    console.log('You clicked on the 2nd quizzing-quizzes item!');
}, false);</code></pre></legend>
    </fieldset>

    <div>
      <input type="checkbox" value="a1513023100719" name="475927" id="a1513023100719">
      <label for="a1513023100719"><p>the capturing phase</p></label>
    </div>
    <div>
      <input type="checkbox" value="a1513023162603" name="475927" id="a1513023162603">
      <label for="a1513023162603"><p>the at target phase</p></label>
    </div>
    <div>
      <input type="checkbox" value="a1513023163097" name="475927" id="a1513023163097">
      <label for="a1513023163097"><p>the bubbling phase</p></label>
    </div>
  </form>

  <details>
    <summary><strong>SOLUTION:</strong></summary>
    <ul>
      <li>the bubbling phase</li>
  </ul>
  </details>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <p>Now that you have a little more knowledge about the "capturing", "at target", and "bubbling" phases, we're going to go back to the question at the beginning of this section. </p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <p><strong>QUIZ QUESTION:</strong>: <p>After running the code below and clicking on the page, two console.log messages will display in the console. Put the messages in the correct order.</p>
<pre><code class="js language-js">document.addEventListener('click', function () {
   console.log('The document was clicked');
});

document.body.addEventListener('click', function () {
    console.log('The body element was clicked');
});</code></pre></p>
  <p><strong>ANSWER CHOICES:</strong></p>
  <button class="btn btn-primary"><p>The document was clicked.</p></button>
  <button class="btn btn-primary"><p>The body element was clicked.</p></button>

  <br><br>

  <table class="table">
    <tr class="thead-dark table-hover">
      <th>
        <p>Order of Messages</p>
      </th>
      <th>
        <p>console.log Message</p>
      </th>
    </tr>

    <tr>
      <td><p>First Message</p></td>
      <td></td>
    </tr>
    <tr>
      <td><p>Second Message</p></td>
      <td></td>
    </tr>
  </table>

  <details>
    <summary><strong>SOLUTION:</strong></summary>

    <table class="table">
      <tr class="thead-dark table-hover">
        <th>
          <p>Order of Messages</p>
        </th>
        <th>
          <p>console.log Message</p>
        </th>
      </tr>

      <tr>
        <td>
          <p>Second Message</p>
        </td>
        <td>
            <button class="btn btn-primary"><p>The document was clicked.</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p>First Message</p>
        </td>
        <td>
            <button class="btn btn-primary"><p>The body element was clicked.</p></button>
        </td>
      </tr>
    </table>
  </details>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h2 id="the-event-object">The Event Object</h2>
<p>Now that you know that event listeners fire in a specific order <em>and</em> how to interpret and control that order, it's time to shift focus to the details of the event itself.</p>
<p>When an event occurs, the browser includes an <strong>event object</strong>. This is just a regular JavaScript object that includes a ton of information about the event itself. According to MDN, the <code>.addEventListener()</code>'s <em>listener</em> function receives:</p>
<blockquote>
  <p>a notification (an object that implements the Event interface) when an event of the specified type occurs</p>
</blockquote>
<p>Up until this point, I've been writing all of the <em>listener</em> functions without any parameter to store this event object. Let's add a parameter so we <em>can</em> store this important information:</p>
<pre><code class="js language-js">document.addEventListener('click', function (event) {  // ← the `event` parameter is new!
   console.log('The document was clicked');
});</code></pre>
<p>Notice the new <code>event</code> parameter that's been added to the listener function. Now when the listener function is called, it is able to store the event data that's passed to it!</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h3 id="💡-an-event-is-an-evt-is-an-e-💡">💡 An "event" is an "evt" is an "e" 💡</h3>
<p>Remember that a function's parameter is just like a regular variable. In the following example, I'm using a parameter with the name <code>event</code>.</p>
<pre><code class="js language-js">const items = document.querySelectorAll('.quizzing-quizzes');
const el = items[1];

el.addEventListener('keypress', function (event) {
    console.log('You clicked on the 2nd quizzing-quizzes item!');
});</code></pre>
<p>Instead of <code>event</code>, the parameter's name could just as easily be:</p>
<ul>
<li><code>evt</code></li>
<li><code>e</code></li>
<li><code>theEvent</code></li>
<li><code>horse</code></li>
</ul>
<p>The name <code>event</code> or <code>evt</code> does not provide any inherent meaning or special capabilities; there is nothing special to the name… it's just the name of the parameter. Feel free to give it any name that's informative/descriptive!</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>DOM L3 44 - Event Object Example</p></h3>
  <video controls>
  <source src="04. DOM L3 44 - Event Object Example-134IQEN89VQ.mp4" type="video/mp4">

  <track default="false" kind="subtitles" srclang="zh-CN" src="04. DOM L3 44 - Event Object Example-134IQEN89VQ.zh-CN.vtt" label="zh-CN">
  <track default="true" kind="subtitles" srclang="en" src="04. DOM L3 44 - Event Object Example-134IQEN89VQ.en.vtt" label="en">
  <track default="false" kind="subtitles" srclang="pt-BR" src="04. DOM L3 44 - Event Object Example-134IQEN89VQ.pt-BR.vtt" label="pt-BR">
  <track default="false" kind="subtitles" srclang="uz" src="04. DOM L3 44 - Event Object Example-134IQEN89VQ.uz.vtt" label="uz">
</video>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h2 id="the-default-action">The Default Action</h2>
<p>As we just looked at, the event object stores a lot of information, and we can use this data to do all sorts of things. However, one incredibly common reason that professionals use the event object for, is to prevent the default action from happening. That sounds like an odd thing to do, but let's explore this.</p>
<p>Think about an anchor link on a webpage. There are probably a couple dozen links on this page! What if you wanted to run some code and display some output when you click on one of these links. If you click on the link, it will automatically navigate you to the location listed in its <code>href</code> attribute: that's what it does by default. </p>
<p>What about a form element? When you submit a form, by default, it will send the data to the location in its <code>action</code> attribute. What if we wanted to validate the data before sending it, though?</p>
<p>Without the event object, we're stuck with the default actions. However, the event object has a <code>.preventDefault()</code> method on it that a handler can call to prevent the default action from occurring!</p>
<pre><code class="js language-js">const links = document.querySelectorAll('a');
const thirdLink = links[2];

thirdLink.addEventListener('click', function (event) {
    event.preventDefault();
    console.log("Look, ma! We didn't navigate to a new page!");
});</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h2 id="recap">Recap</h2>
<p>We covered a number of important aspects of events and event listeners in this section! We looked at:</p>
<ul>
<li>the phases of an event:<ul>
<li>the <code>capturing</code> phase</li>
<li>the <code>at target</code> phase</li>
<li>the <code>bubbling</code> phase</li></ul></li>
<li>the event object</li>
<li>prevent the default action with <code>.preventDefault()</code></li>
</ul>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h3 id="further-research">Further Research</h3>
<ul>
<li><a href="https://www.w3.org/TR/DOM-Level-3-Events/#event-flow" rel="noopener noreferrer" target="_blank">Event dispatch and DOM event flow</a> on W3C<ul>
<li><a href="https://www.w3.org/TR/DOM-Level-3-Events/#capture-phase" rel="noopener noreferrer" target="_blank">capture phase</a> on W3C</li>
<li><a href="https://www.w3.org/TR/DOM-Level-3-Events/#target-phase" rel="noopener noreferrer" target="_blank">target phase</a> on W3C</li>
<li><a href="https://www.w3.org/TR/DOM-Level-3-Events/#bubble-phase" rel="noopener noreferrer" target="_blank">bubble phase</a> on W3C</li></ul></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Event" rel="noopener noreferrer" target="_blank">Event</a> on MDN</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/Events" rel="noopener noreferrer" target="_blank">Event reference</a> on MDN</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener" rel="noopener noreferrer" target="_blank">addEventListener</a> on MDN</li>
</ul>
</div>

</div>
<div class="divider"></div>
          </div>

          <div class="col-12">
            <p class="text-right">
              <a href="05. Avoid Too Many Events.html" class="btn btn-outline-primary mt-4" role="button">Next Concept</a>
            </p>
          </div>
        </div>
      </main>

      <footer class="footer">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <p class="text-center">
                <a href="https://us-udacity.github.io/" target="_blank">【udacity2.0 】If you need more courses, please add wechat：udacity6</a>
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>


  <script src="../assets/js/jquery-3.3.1.min.js"></script>
  <script src="../assets/js/plyr.polyfilled.min.js"></script>
  <script src="../assets/js/bootstrap.min.js"></script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
  <script src="../assets/js/katex.min.js"></script>
  <script>
    // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('04. Phases of an Event')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
</body>

</html>
